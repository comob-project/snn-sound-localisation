## Contralateral glycinergic inhibition as key factor in creating ITD sensitivity

### Intro
Why a more biological inspired model? 
- Existance of both ITDs and ILDs for azimuthal sounds localization
- Problem of ITD sensitivity: their duration is in the range of microseonds whereas neuronal dynamics work in the millisecond range.
- Jeffress model existence in mammals is not sure
- axonal delay lines absence in mammalian MSO
- peaks of MSO responses only for contralateral sounds, outside physiological range? Slopes as the encoding part of the curves
- experiments with inhibition blocked (glycine antagonist strychnine) show loss of ITD-coding in the MSO principal cells (see 10.1523/JNEUROSCI.1660-08.2008)

### Introduction Text 
For the vast majority of animals, sound localization is realized through two classes of hidden acoustic cues: binaural and spectral cues. In humans, binaural cues alone are sufficient to discriminate azimuth angles between 0-180 degrees, whereas psychoacoustic evidence has shown how spectral cues have a role in the solution of front-back ambiguities and in angle recognition along the vertical plane (i.e. elevation angles).
Focusing on binaural cues, the two main signals exploited by different animals in creating an acoustic spatiality are interaural time and level differences (ITDs and ILDs). Their role and their dominance over each other depend mainly on animal head size and hearing range in terms of frequencies. 
It is clear at first glance how ITDs assume significant values for species with large head sizes while being much smaller, and so much harder to neuronally encode, for smaller animals. ILDs on the other hand occur when the wavelength of the sound stimulus is shorter than the size of the animal's head, which then generates a significant attenuation at the contralateral ear. For this reason, ILDs' significance with respect to ITDs is greater in smaller animals with a middle ear specialised for the transmission of high frequencies. 
These data soon led to the conclusion that in humans, whose audible range is centred on lower frequencies than in other mammals, the ITD was the main binaural cue in discriminating different azimuth angles. For this reason, the most important model that attempts to explain human sound localization, namely the Jeffress Model, only takes ITDs into account and proposes a theoretical circuit consisting of axonal delay lines at the level of the brainstem that can create this type of sensitivity. For many years, Jeffress's remained the most accepted proposal, given the discovery of axonal lines potentially similar to those theorised by Jeffress in the Nucleo Laminaris (NL) of different bird species. However, the presence of similar delay lines in the mammalian nucleus called the medial superior olive (MSO), within the superior olivary complex and analogous to the avian NL, has never been demonstrated. 

The first steps into a better understanding of the MSO functioning were made thanks to the work of Brand et al, 2002, in which the analysis of in vivo recordings from the MSO of the Mongolian gerbil shown how all the 20 neurons tested responded maximally to sounds leading in time at the contralateral ear. Peaks in the firing rate of these neurons were found also for ITD values higher than the highest possible ones generated by the gerbil head, which correspond to almost 120 us for a sound coming at 90 degrees angle from the contralateral hemispace. This observation led to the hypothesis that peaks in these neurons firing rate were not coding for a specific ITD value in gerbil relevant physiological space, suggesting instead a mapping made by the slopes in the activity curves, in a way similar to the rate-coding strategy adopted for ILDs in the Lateral Superior Olive (even if the slopes in LSO cells response increases from contralateral ILD values going towards ipsilateral ones, oppositely from what happens in MSO cells response). The idea of a topographic map at the level of the MSO portrayed by different peaks in cells activity risks then to be discarded in favour of a less refined rate-coding strategy, in which recognition of the ITD value generated by an input sound should occur at a higher level, following integration on the activity of a population cluster.
The same study of Brand et al, together with a following one by Pecka et al, explored also the physical mechanisms underlying the shift in peaks activity towards contralateral ITD values. Since the presence of axonal delay lines had been discarded, there had to be another neural mechanism capable of compensating for the external ITD value, causing a growth in the activity of MSO neurons for gradually more and more contralateral sounds. The results shown how glycinergic inhibitory inputs to the MSO had a central role in this process. By blocking the two main inhibitory inputs to the MSO principal cells, one coming ipsilaterally from the Lateral Nucleus of the Trapezoidal Body (LNTB) and one contralaterally via the Medial Nucleus of the opposite Trapezoid Body (MNTB), they observed the loss of the peak shift in all their response activity. Having now a symmetry in all the responses, with a peak in the activity corresponding to null ITD values (and so frontal azimuth angles), all the information present in the MSO responses had been lost. Inhibition have thus a central role in identifying the ITD values in the MSO, whether that the coding strategy adopted consists in a peak-coding or in a rate coding one. However, even in this case, although numerous proposals have been made, it is still unclear how the two inhibitory inputs manage to cause this higher excitability of MSO neurons for contralateral sounds.
Some experimental studies have reported how inhibitory inputs, especially the contralateral one, can arrive slightly in advance of the excitatory inputs from the corresponding sides, thus going to influence the way ipsilateral and contralateral inputs add up in the MSO neurons and thereby generate a maximum response for contralateral ITD values. Nevertheless, other work has characterized the hypothesis of anticipation of inhibitory inputs as implausible. For this reason, in our work, we explored the validity of another hypothesis related solely to the shape of post-synaptic potentials (PSPs), both excitatory and inhibitory, by going to test different sets of time constants that then govern the shape of PSPs.


### Methods
The network was mainly developed in Python using the NEST Simulator framework. Inspired by the neurophysiological data, we implemented a complex spiking neural network composed of more than 170,000 spiking units. The different neuronal populations composing the brainstem circuit and their interconnections are depicted in [](#model_map1). 

```{figure} https://github.com/francescodesantis/snn-sound-localization/assets/96658597/2a9a3283-e92b-4e37-95f7-3f1d3a88dc28
:label:model_map1

The end-to-end system with the network diagram
```

The principal inputs to the network are the spectrogram of a sound stimulus arriving at both ears and the azimuth angle from which univocal values of ITD and ILD are computed. With regards to the spectrogram, we covered the whole human audible range of sound between a minimum frequency of 20 Hz and a maximum of 20 kHz. We subdivided it into 3500 channels since this value is the most likely estimate of the number of inner hair cells (IHCs) present in the human cochlea. With the intent to mimic the physiological distribution of IHCs along the basilar membrane, the width of each frequency channel was not constant throughout the range but grew exponentially.
For modelling of the auditory nerve fibers (ANFs) we used the pulse_packet_generator, a build-in NEST device that produces a spike train containing Gaussian spike clusters centered about given times. 
These devices mimic the real behaviour of ANFs subjected to a pure tone stimulus, since the firing of these neurons has the tendency to happen many times only at a certain, restricted phase of the input sinusoidal sound wave, through the phenomenon called phase locking.
pulse_packet_generator allowed to define the number of spikes in each packet with normal distributed random displacements from the centre time of the pulse [Nest]. This allows us to implement ILDs by varying the spikes_number parameter according to the input azimuth angle. A source of noise was introduced by setting the standard deviation of the random displacement from the centre of the pulse equal to 0.1 ms.
The value of ITD was instead computed considering the interaural path difference, which is the difference between the paths travelled by the sound starting from the source and arriving at the two ears, and dividing it by the speed of sound in air (i.e., 330 m/s). For ILDs, a maximum attenuation of 2 dB was provided to the ear contralateral to the origin of the sound for azimuth angles of ±90°. 

The MSO principal cells were modelled trough iaf_cond_beta model, a simple implementation of a spiking neuron in NEST using integrate-and-fire dynamics with conductance-based synapses. In this model, incoming spike events induce a postsynaptic change of conductance modelled by a beta function. The use of a beta function allowed us to change independently the time constants of rise and fall of the conductance change and thus to modify both the excitatory and inhibitory post-synaptic potential shapes in the MSO. In this way, we could explore different set of values and attempt to validate our hypothesis about how inhibitory inputs could code for different ITD values in MSO cells [see Introduction].
All the other neuronal populations, except for ANFs and MSO cells, were modelled with the iaf_cond_alpha, since there was no need for modifying the PSPs shape of their inputs.
For the validation of the complete brainstem network, comprising both LSO and MSO of both sides, sound stimuli with frequencies of 100 Hz and 1 s duration from different spatial positions were tested. Specifically, we gave the model azimuth angles ranging from -90° to +90° with an interval of 15°. 

The MSO response was tested both in physiological conditions and with blocked inhibitory inputs, as in the experiments of Brand et al and Pecka et al.


### Results --> I have to introduce updates

As the first result concerning the spiking activity of brainstem neural populations, a refinement of phase locking was obtained at the level of the spherical and globular bushy cells, which then exhibited a behaviour faithful to their biological counterparts. 

About the LSO, the responses in terms of firing rate following stimulation with different pure tones (i.e., with different CFs) presented the desired subtraction process described, regardless of the stimulation CF, as depicted in [](#LSO1). 

```{figure} https://github.com/francescodesantis/snn-sound-localization/assets/96658597/428de33c-d5fb-405f-b44e-949f701374fa
:label: LSO1

Firing rates and spike trains of left and right LSO populations after different stimulus frequencies.
```

Indeed, the nuclei on both sides show low response values for stimuli from contralateral azimuth angles, with a minimum at +90° for the left LSO and at -90° for the right LSO. This is due to the greater strength and speed of inhibition compared to ipsilateral excitation.

Considering the right LSO, for the sake of simplicity, when the sound arrives from a source placed at -90°, the contralateral ear (left) receives sounds earlier and more intensely than the ipsilateral ear (right). As the azimuth angle proceeds toward 0° (frontal position), the firing rate increases while maintaining a constant slope. This steep segment is the most informative part of the right LSO response curve, as a high sensitivity to changing input azimuth angles is guaranteed. Once past 0°, the firing rate ceases to increase steadily, and the response flattens out to high rate values. Here, the ipsilateral (right) excitation dominates due to positive ITD and ILD concerning the contralateral ear.

Regarding the MSO, at the microscopic level, inhibition of increasing strength leads to an increasing reduction of the membrane potential in the principal cells. In detail, small inhibitory weights delay the spike instant of the cell and then altogether abolish the potential spike when they take larger values, keeping the membrane potential below the threshold, as depicted in [](#inhibition7).

```{figure} https://github.com/francescodesantis/snn-sound-localization/assets/96658597/43aa94a4-1848-4320-8477-3cc709f00af0
:label: inhibition7

Trends of the membrane potential of two cells belonging to the same battery (same CF) showed on a single period during a pure tone stimulation at 100 Hz at 0° and duration of 100 ms. The inhibitory post-synaptic potential (IPSP) leads to a shift and then, for larger weights, to the cancellation of the neuron spike. As in [2], the contralateral IPSP is fast and anticipates both the ipsilateral and the contralateral excitatory post-synaptic potentials.
```

On the other hand, on a global level, by evaluating the firing rate of an entire battery of principal cells for different locations we first noticed that only five neurons out of the ten that made up a battery had a significant firing rate, while in the five that received stronger inhibitory synapses from the contralateral side (i.e., weight from -12 to -24 nS) the number of spikes during the entire simulation was too low or even null. The trend in the responses of the first five neurons is similar to that of the LSO, with a steeper and more informative positive slope for contralateral stimuli ([](#mso5)). 

```{figure} https://github.com/francescodesantis/snn-sound-localization/assets/96658597/4900480c-eba9-4d56-b5ae-9adafa29c43d
:label: mso5

Normalised responses of the first five neurons of the MSO batteries of both sides. Normalisation was obtained by dividing the firing rate of each neuron composing the battery by the maximum attained by spanning all the different azimuth angles. The shaded area corresponds approximately to the physiological range of ITD in the human context.
```

On the other hand, for ipsilateral angles, we can observe a second (negative) slope, less steep than the previous one but still potentially more informative than the plateau found in the same region for LSO curves ([](#LSO1)).

The predictions of the entire brainstem network for the different azimuth angles and for the different configurations tested are described by the RMSE, R, and its p-value presented in [](#performance_inh).

:::{table} Comparison of performance between the six configurations. In bold, the best performance.
:label: performance_inh

| Configuration: | 1           | 2           | 3           | 4           | 5           | **6**            |
|----------------|-------------|-------------|-------------|-------------|-------------|--------------|
| RMSE           | 19.297 deg  | 11.527 deg  | 21.397 deg  | 18.072 deg  | 15.777 deg  | **11.06 deg**    |
| R              | 0.947       | 0.979       | 0.948       | 0.961       | 0.961       | **0.983**        |
| p value        | 9.578*10<sup>-7</sup> | 5.891*10<sup>-9</sup> | 8.782*10<sup>-7</sup> | 1.695*10<sup>-7</sup> | 1.944*10<sup>-7</sup> | **1.658*10<sup>-9</sup>** |\

:::

The first important result that can be deduced from these data concerns the improvement in the overall network performance when integration is made between the LSO and the MSO. Both in the case of configuration "5" compared to "3" and "1", and in the case of "6" compared with "4" and "2", a meaningful performance improvement was found. This result, therefore, validates the existence of a dual pathway in the mammalian brainstem, in which both binaural cues (ITD and ILD) play an essential role in the accurate recognition of the position in the horizontal plane of a sound stimulus. A second observation can be made about using information from both ipsilateral and contralateral nuclei (configurations "1", "3", and "5") compared to the exploitation of the contralateral nucleus only (configurations "2", "4", and "6"). The information given only by the LSO and MSO contralateral to the input sound stimulus, without integrating the one coming from the ipsilateral ones, improves the model’s performance ([](#inh_results_config_6)).

:::{attention}
Figure below needs a black background, please update.
:::

<div style="background-color: black;">

```{figure} https://github.com/francescodesantis/snn-sound-localization/assets/96658597/c12ccd0e-9bd8-4d6c-8463-009a52da1a16
:label: inh_results_config_6

Model’s results for configuration "6", in which predictions are obtained by considering only LSO and MSO contralateral to
the stimulus. The results were obtained with an input tone of 100 Hz and a duration of 1 s for different azimuth angles.
```

</div>

The results obtained show how the role of fast and dominant inhibitory inputs to the LSO and MSO can be crucial in distinguishing between different azimuth angles.
The spiking neural network implementation of the brainstem also demonstrated how the encodings of different ITDs do not necessarily have to be generated by the activity peaks of different cells in the MSO but, on the contrary, they can be coded by the slope in the response firing rates within the range of physiological ITDs. Furthermore, this work has shown how the integration of information from LSO and MSO allows for more accurate localizations than the responses of the two nuclei taken individually, at least for pure tones of 100 Hz frequency.
